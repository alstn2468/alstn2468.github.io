{"componentChunkName":"component---src-templates-blog-post-js","path":"/MachineLearning/2019-05-02-BasicChapter8-3","result":{"data":{"site":{"siteMetadata":{"title":"Minsu's Dev Log","author":"Minsu Kim","siteUrl":"https://alstn2468.github.io","comment":{"disqusShortName":"","utterances":"alstn2468/alstn2468.github.io"},"sponsor":{"buyMeACoffeeId":"eMLdEwU"}}},"markdownRemark":{"id":"19fa23a8-84de-5b06-9d22-702867770f73","excerpt":"해당 게시물은 Edwith에서 제공하는\n머신러닝과 딥러닝 BASIC을 듣고 요약 정리한 글입니다. Training and Test data sets Data Set을 Training Set과 Test Set으로 나누어 진행 이러한 상황에서 가 유용하다.\n를 이용해서 어떠한 값이 들어올 때\nTraiining Set을 에 넣어서 학습시키고\nTest Set을 에 넣어서 테스트를 진행하면 된다. 여기에서 Accuracy와 Predection의 값은\nTraining Set…","html":"<p>해당 게시물은 <a href=\"https://www.edwith.org\">Edwith</a>에서 제공하는<br/>\n<a href=\"https://www.edwith.org/others26/joinLectures/9829\">머신러닝과 딥러닝 BASIC</a>을 듣고 요약 정리한 글입니다.</p>\n<h2 id=\"training-and-test-data-sets\" style=\"position:relative;\"><a href=\"#training-and-test-data-sets\" aria-label=\"training and test data sets permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Training and Test data sets</h2>\n<p><strong>Data Set</strong>을 <strong>Training Set</strong>과 <strong>Test Set</strong>으로 나누어 진행<br/></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># Training Set</span>\nx_data <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span>\ny_data <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\"># Test Set</span>\nx_test <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span>\ny_test <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span></code></pre></div>\n<p>이러한 상황에서 <code class=\"language-text\">placeholder</code>가 유용하다.<br/>\n<code class=\"language-text\">placeholder</code>를 이용해서 어떠한 값이 들어올 때<br/>\n<strong>Traiining Set</strong>을 <code class=\"language-text\">placeholder</code>에 넣어서 학습시키고<br/>\n<strong>Test Set</strong>을 <code class=\"language-text\">placeholder</code>에 넣어서 테스트를 진행하면 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> tensorflow <span class=\"token keyword\">as</span> tf\n\nX <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>placeholder<span class=\"token punctuation\">(</span><span class=\"token string\">\"float\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nY <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>placeholder<span class=\"token punctuation\">(</span><span class=\"token string\">\"float\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nW <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>random_normal<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nb <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>random_normal<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nhypothesis <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>nn<span class=\"token punctuation\">.</span>softmax<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>matmul<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">,</span> W<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> b<span class=\"token punctuation\">)</span>\ncost <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>reduce_mean<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>tf<span class=\"token punctuation\">.</span>reduce_sum<span class=\"token punctuation\">(</span>Y <span class=\"token operator\">*</span> tf<span class=\"token punctuation\">.</span>log<span class=\"token punctuation\">(</span>hypothesis<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> axis<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\noptimizer <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>train<span class=\"token punctuation\">.</span>GradientDescentOptimizer<span class=\"token punctuation\">(</span>learning_rate<span class=\"token operator\">=</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>minimize<span class=\"token punctuation\">(</span>cost<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Correct prediction Test model</span>\nprediction <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>argmax<span class=\"token punctuation\">(</span>hypothesis<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\nis_correct <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>equal<span class=\"token punctuation\">(</span>prediction<span class=\"token punctuation\">,</span> tf<span class=\"token punctuation\">.</span>argmax<span class=\"token punctuation\">(</span>Y<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\naccuracy <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>reduce_mean<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>cast<span class=\"token punctuation\">(</span>is_correct<span class=\"token punctuation\">,</span> tf<span class=\"token punctuation\">.</span>float32<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Launch graph</span>\n<span class=\"token keyword\">with</span> tf<span class=\"token punctuation\">.</span>Session<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> sess<span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># Initialize Tenserflow variables</span>\n    sess<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>global_variables_initializer<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">for</span> step <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">201</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        cost_val<span class=\"token punctuation\">,</span> W_val<span class=\"token punctuation\">,</span> _ <span class=\"token operator\">=</span> sess<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>cost<span class=\"token punctuation\">,</span> W<span class=\"token punctuation\">,</span> optimizer<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                                      feed_dict<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>X<span class=\"token punctuation\">:</span> x_data<span class=\"token punctuation\">,</span> Y<span class=\"token punctuation\">:</span> y_data<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n        <span class=\"token keyword\">if</span> step <span class=\"token operator\">%</span> <span class=\"token number\">20</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>step<span class=\"token punctuation\">,</span> cost_val<span class=\"token punctuation\">,</span> W_val<span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># Predict</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Prediction :\"</span><span class=\"token punctuation\">,</span> sess<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>prediction<span class=\"token punctuation\">,</span> feed_dict<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>X<span class=\"token punctuation\">:</span> x_test<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># Calculate the accuracy</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Accuracy :\"</span><span class=\"token punctuation\">,</span> sess<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>accuracy<span class=\"token punctuation\">,</span> feed_dict<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>X<span class=\"token punctuation\">:</span> x_test<span class=\"token punctuation\">,</span> Y<span class=\"token punctuation\">:</span> y_test<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">0 4.1074553 [[-1.4293944  -0.7224384   2.848082  ]\n [ 1.1112422  -0.3999512  -0.71154207]\n [-0.15248409  0.17528887  0.5048751 ]]\n20 0.7546797 [[-1.5631142  -0.5818348   2.841198  ]\n [ 0.72321707 -0.0059972  -0.71747077]\n [-0.10348553  0.66835874 -0.03719316]]\n40 0.6795351 [[-1.6549793  -0.5410513   2.8922794 ]\n [ 0.56363654 -0.01940873 -0.54447865]\n [ 0.08512951  0.65142184 -0.20887122]]\n60 0.63409156 [[-1.7386525  -0.5033351   2.9382365 ]\n [ 0.4421414  -0.01824449 -0.42414775]\n [ 0.2345651   0.6264432  -0.33332816]]\n80 0.6051625 [[-1.8194332  -0.4668002   2.9824824 ]\n [ 0.35451818 -0.01411752 -0.34065136]\n [ 0.34999305  0.60314    -0.42545283]]\n100 0.58531666 [[-1.8991535  -0.43095058  3.0263534 ]\n [ 0.29415295 -0.01108143 -0.28332224]\n [ 0.43837747  0.58400047 -0.49469772]]\n120 0.57030904 [[-1.9780612  -0.39590144  3.0702124 ]\n [ 0.25370523 -0.00954942 -0.24440636]\n [ 0.50700086  0.5684458  -0.54776627]]\n140 0.55791247 [[-2.0558922  -0.3618978   3.1140394 ]\n [ 0.22686873 -0.00888192 -0.2182373 ]\n [ 0.5619558   0.5552294  -0.58950466]]\n160 0.54703254 [[-2.13234    -0.32911745  3.1577072 ]\n [ 0.20899145 -0.00845987 -0.20078206]\n [ 0.6076821   0.5433617  -0.6233629 ]]\n180 0.5371375 [[-2.2071946  -0.29763928  3.2010844 ]\n [ 0.19691719 -0.00792996 -0.18923767]\n [ 0.64718145  0.53225446 -0.65175486]]\n200 0.5279585 [[-2.2803524  -0.26746872  3.2440712 ]\n [ 0.18859148 -0.0071582  -0.18168372]\n [ 0.6824146   0.5216165  -0.6763497 ]]\nPrediction : [2 2 2]\nAccuracy : 1.0</code></pre></div>\n<p>여기에서 <strong>Accuracy</strong>와 <strong>Predection</strong>의 값은<br/>\n<strong>Training Set</strong>을 가지고 학습시킨 모델을 가지고<br/>\n<strong>Test Set</strong>을 예측한 값으로 모델 입장에서 한 번도<br/>\n<strong>학습하지 않은 데이터</strong>로 예측을한 의미가 있는 결과 값이다.</p>\n<h2 id=\"large-learning-rate\" style=\"position:relative;\"><a href=\"#large-learning-rate\" aria-label=\"large learning rate permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Large Learning Rate</h2>\n<p>Learning Rate가 너무 클경우</p>\n<ul>\n<li><strong>Overshooting</strong></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> tensorflow <span class=\"token keyword\">as</span> tf\n\nX <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>placeholder<span class=\"token punctuation\">(</span><span class=\"token string\">\"float\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nY <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>placeholder<span class=\"token punctuation\">(</span><span class=\"token string\">\"float\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nW <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>random_normal<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nb <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>random_normal<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nhypothesis <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>nn<span class=\"token punctuation\">.</span>softmax<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>matmul<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">,</span> W<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> b<span class=\"token punctuation\">)</span>\ncost <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>reduce_mean<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>tf<span class=\"token punctuation\">.</span>reduce_sum<span class=\"token punctuation\">(</span>Y <span class=\"token operator\">*</span> tf<span class=\"token punctuation\">.</span>log<span class=\"token punctuation\">(</span>hypothesis<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> axis<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\noptimizer <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>train<span class=\"token punctuation\">.</span>GradientDescentOptimizer<span class=\"token punctuation\">(</span>learning_rate<span class=\"token operator\">=</span><span class=\"token number\">1.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>minimize<span class=\"token punctuation\">(</span>cost<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Correct prediction Test model</span>\nprediction <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>argmax<span class=\"token punctuation\">(</span>hypothesis<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\nis_correct <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>equal<span class=\"token punctuation\">(</span>prediction<span class=\"token punctuation\">,</span> tf<span class=\"token punctuation\">.</span>argmax<span class=\"token punctuation\">(</span>Y<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\naccuracy <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>reduce_mean<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>cast<span class=\"token punctuation\">(</span>is_correct<span class=\"token punctuation\">,</span> tf<span class=\"token punctuation\">.</span>float32<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Launch graph</span>\n<span class=\"token keyword\">with</span> tf<span class=\"token punctuation\">.</span>Session<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> sess<span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># Initialize Tenserflow variables</span>\n    sess<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>global_variables_initializer<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">for</span> step <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">201</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        cost_val<span class=\"token punctuation\">,</span> W_val<span class=\"token punctuation\">,</span> _ <span class=\"token operator\">=</span> sess<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>cost<span class=\"token punctuation\">,</span> W<span class=\"token punctuation\">,</span> optimizer<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                                      feed_dict<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>X<span class=\"token punctuation\">:</span> x_data<span class=\"token punctuation\">,</span> Y<span class=\"token punctuation\">:</span> y_data<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n        <span class=\"token keyword\">if</span> step <span class=\"token operator\">%</span> <span class=\"token number\">20</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>step<span class=\"token punctuation\">,</span> cost_val<span class=\"token punctuation\">,</span> W_val<span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># Predict</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Prediction :\"</span><span class=\"token punctuation\">,</span> sess<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>prediction<span class=\"token punctuation\">,</span> feed_dict<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>X<span class=\"token punctuation\">:</span> x_test<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># Calculate the accuracy</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Accuracy :\"</span><span class=\"token punctuation\">,</span> sess<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>accuracy<span class=\"token punctuation\">,</span> feed_dict<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>X<span class=\"token punctuation\">:</span> x_test<span class=\"token punctuation\">,</span> Y<span class=\"token punctuation\">:</span> y_test<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">0 5.1369658 [[-0.16136795 -0.052203    1.2202002 ]\n [ 1.7465985  -3.63817     1.3205297 ]\n [ 0.01285887 -4.4370604   0.21666038]]\n20 nan [[nan nan nan]\n [nan nan nan]\n [nan nan nan]]\n40 nan [[nan nan nan]\n [nan nan nan]\n [nan nan nan]]\n60 nan [[nan nan nan]\n [nan nan nan]\n [nan nan nan]]\n80 nan [[nan nan nan]\n [nan nan nan]\n [nan nan nan]]\n100 nan [[nan nan nan]\n [nan nan nan]\n [nan nan nan]]\n120 nan [[nan nan nan]\n [nan nan nan]\n [nan nan nan]]\n140 nan [[nan nan nan]\n [nan nan nan]\n [nan nan nan]]\n160 nan [[nan nan nan]\n [nan nan nan]\n [nan nan nan]]\n180 nan [[nan nan nan]\n [nan nan nan]\n [nan nan nan]]\n200 nan [[nan nan nan]\n [nan nan nan]\n [nan nan nan]]\nPrediction : [0 0 0]\nAccuracy : 0.0</code></pre></div>\n<p>Learning rate를 1.5로 올린 결과 <strong>Overshooting</strong>이<br/>\n발생해 학습이 잘 되지않은 모델이 생성되어 예측이 잘 되지않았다.</p>\n<h2 id=\"learning-rate가-너무-작을-경우\" style=\"position:relative;\"><a href=\"#learning-rate%EA%B0%80-%EB%84%88%EB%AC%B4-%EC%9E%91%EC%9D%84-%EA%B2%BD%EC%9A%B0\" aria-label=\"learning rate가 너무 작을 경우 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Learning Rate가 너무 작을 경우</h2>\n<ul>\n<li>Many iterations</li>\n<li>Local minima에 빠질 수 있다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> tensorflow <span class=\"token keyword\">as</span> tf\n\nX <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>placeholder<span class=\"token punctuation\">(</span><span class=\"token string\">\"float\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nY <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>placeholder<span class=\"token punctuation\">(</span><span class=\"token string\">\"float\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nW <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>random_normal<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nb <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>random_normal<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nhypothesis <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>nn<span class=\"token punctuation\">.</span>softmax<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>matmul<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">,</span> W<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> b<span class=\"token punctuation\">)</span>\ncost <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>reduce_mean<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>tf<span class=\"token punctuation\">.</span>reduce_sum<span class=\"token punctuation\">(</span>Y <span class=\"token operator\">*</span> tf<span class=\"token punctuation\">.</span>log<span class=\"token punctuation\">(</span>hypothesis<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> axis<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\noptimizer <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>train<span class=\"token punctuation\">.</span>GradientDescentOptimizer<span class=\"token punctuation\">(</span>learning_rate<span class=\"token operator\">=</span><span class=\"token number\">1e-10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>minimize<span class=\"token punctuation\">(</span>cost<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Correct prediction Test model</span>\nprediction <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>argmax<span class=\"token punctuation\">(</span>hypothesis<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\nis_correct <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>equal<span class=\"token punctuation\">(</span>prediction<span class=\"token punctuation\">,</span> tf<span class=\"token punctuation\">.</span>argmax<span class=\"token punctuation\">(</span>Y<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\naccuracy <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>reduce_mean<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>cast<span class=\"token punctuation\">(</span>is_correct<span class=\"token punctuation\">,</span> tf<span class=\"token punctuation\">.</span>float32<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Launch graph</span>\n<span class=\"token keyword\">with</span> tf<span class=\"token punctuation\">.</span>Session<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> sess<span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># Initialize Tenserflow variables</span>\n    sess<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>global_variables_initializer<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">for</span> step <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">201</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        cost_val<span class=\"token punctuation\">,</span> W_val<span class=\"token punctuation\">,</span> _ <span class=\"token operator\">=</span> sess<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>cost<span class=\"token punctuation\">,</span> W<span class=\"token punctuation\">,</span> optimizer<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                                      feed_dict<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>X<span class=\"token punctuation\">:</span> x_data<span class=\"token punctuation\">,</span> Y<span class=\"token punctuation\">:</span> y_data<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n        <span class=\"token keyword\">if</span> step <span class=\"token operator\">%</span> <span class=\"token number\">20</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>step<span class=\"token punctuation\">,</span> cost_val<span class=\"token punctuation\">,</span> W_val<span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># Predict</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Prediction :\"</span><span class=\"token punctuation\">,</span> sess<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>prediction<span class=\"token punctuation\">,</span> feed_dict<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>X<span class=\"token punctuation\">:</span> x_test<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># Calculate the accuracy</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Accuracy :\"</span><span class=\"token punctuation\">,</span> sess<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>accuracy<span class=\"token punctuation\">,</span> feed_dict<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>X<span class=\"token punctuation\">:</span> x_test<span class=\"token punctuation\">,</span> Y<span class=\"token punctuation\">:</span> y_test<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">0 4.4417534 [[ 1.6614894  -2.5569797   1.3669713 ]\n [-0.43707097  1.3632766   1.4774112 ]\n [-0.6081834   0.77286756  0.4197207 ]]\n20 4.4417534 [[ 1.6614894  -2.5569797   1.3669713 ]\n [-0.43707097  1.3632766   1.4774112 ]\n [-0.6081834   0.77286756  0.4197207 ]]\n40 4.4417534 [[ 1.6614894  -2.5569797   1.3669713 ]\n [-0.43707097  1.3632766   1.4774112 ]\n [-0.6081834   0.77286756  0.4197207 ]]\n60 4.4417534 [[ 1.6614894  -2.5569797   1.3669713 ]\n [-0.43707097  1.3632766   1.4774112 ]\n [-0.6081834   0.77286756  0.4197207 ]]\n80 4.4417534 [[ 1.6614894  -2.5569797   1.3669713 ]\n [-0.43707097  1.3632766   1.4774112 ]\n [-0.6081834   0.77286756  0.4197207 ]]\n100 4.4417534 [[ 1.6614894  -2.5569797   1.3669713 ]\n [-0.43707097  1.3632766   1.4774112 ]\n [-0.6081834   0.77286756  0.4197207 ]]\n120 4.4417534 [[ 1.6614894  -2.5569797   1.3669713 ]\n [-0.43707097  1.3632766   1.4774112 ]\n [-0.6081834   0.77286756  0.4197207 ]]\n140 4.4417534 [[ 1.6614894  -2.5569797   1.3669713 ]\n [-0.43707097  1.3632766   1.4774112 ]\n [-0.6081834   0.77286756  0.4197207 ]]\n160 4.4417534 [[ 1.6614894  -2.5569797   1.3669713 ]\n [-0.43707097  1.3632766   1.4774112 ]\n [-0.6081834   0.77286756  0.4197207 ]]\n180 4.4417534 [[ 1.6614894  -2.5569797   1.3669713 ]\n [-0.43707097  1.3632766   1.4774112 ]\n [-0.6081834   0.77286756  0.4197207 ]]\n200 4.4417534 [[ 1.6614894  -2.5569797   1.3669713 ]\n [-0.43707097  1.3632766   1.4774112 ]\n [-0.6081834   0.77286756  0.4197207 ]]\nPrediction : [0 0 2]\nAccuracy : 0.33333334</code></pre></div>\n<p>Learning rate를 1e-10으로 낮추었더니,<br>\ncost가 줄어들지 않고 학습이 이루어지지 않은 결과가 생겼다.</p>\n<h2 id=\"non-normalized-inputs\" style=\"position:relative;\"><a href=\"#non-normalized-inputs\" aria-label=\"non normalized inputs permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Non-normalized inputs</h2>\n<p>아래와 같이 데이터들 간의 차이가 큰 Data Set을 사용하면<br/>\n한쪽 방향으로 치우쳐진 <strong>왜곡된 그래프</strong>가 그려지게 된다.</p>\n<table>\n<thead>\n<tr>\n<th>x_data (xy[:, 0:-1])</th>\n<th>y_data (xy[:, [-1])</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>[828.659973, 833.450012, 908100, 828.349976]</td>\n<td>[831.659973]</td>\n</tr>\n<tr>\n<td>[823.02002, 828.070007, 1828100, 821.655029]</td>\n<td>[828.070007]</td>\n</tr>\n<tr>\n<td>[816, 820.958984, 1008100, 815.48999]</td>\n<td>[819.23999]</td>\n</tr>\n<tr>\n<td>[819.359985, 823, 1188100, 818.469971]</td>\n<td>[818.97998]</td>\n</tr>\n<tr>\n<td>[819, 823, 1198100, 816]</td>\n<td>[820.450012]</td>\n</tr>\n<tr>\n<td>[811.700012, 815.25, 1098100, 809.780029]</td>\n<td>[813.669983]</td>\n</tr>\n<tr>\n<td>[809.51001, 816.659973, 1398100, 804.539978]</td>\n<td>[809.559998]</td>\n</tr>\n</tbody>\n</table>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n\nxy <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">828.659973</span><span class=\"token punctuation\">,</span> <span class=\"token number\">833.450012</span><span class=\"token punctuation\">,</span> <span class=\"token number\">908100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">828.349976</span><span class=\"token punctuation\">,</span> <span class=\"token number\">831.659973</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">823.02002</span><span class=\"token punctuation\">,</span> <span class=\"token number\">828.070007</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1828100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">821.655029</span><span class=\"token punctuation\">,</span> <span class=\"token number\">828.070007</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">819.929993</span><span class=\"token punctuation\">,</span> <span class=\"token number\">824.400024</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1438100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">818.97998</span><span class=\"token punctuation\">,</span> <span class=\"token number\">824.159973</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">816</span><span class=\"token punctuation\">,</span> <span class=\"token number\">820.958984</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1008100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">815.48999</span><span class=\"token punctuation\">,</span> <span class=\"token number\">819.23999</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">819.359985</span><span class=\"token punctuation\">,</span> <span class=\"token number\">823</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1188100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">818.469971</span><span class=\"token punctuation\">,</span> <span class=\"token number\">818.97998</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">819</span><span class=\"token punctuation\">,</span> <span class=\"token number\">823</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1198100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">816</span><span class=\"token punctuation\">,</span> <span class=\"token number\">820.450012</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">811.700012</span><span class=\"token punctuation\">,</span> <span class=\"token number\">815.25</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1098100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">809.780029</span><span class=\"token punctuation\">,</span> <span class=\"token number\">813.669983</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">809.51001</span><span class=\"token punctuation\">,</span> <span class=\"token number\">816.659973</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1398100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">804.539978</span><span class=\"token punctuation\">,</span> <span class=\"token number\">809.559998</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nx_data <span class=\"token operator\">=</span> xy<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\ny_data <span class=\"token operator\">=</span> xy<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\"># Placeholder for a tensor that will be always frd.</span>\nX <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>placeholder<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>float32<span class=\"token punctuation\">,</span> shape<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nY <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>placeholder<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>float32<span class=\"token punctuation\">,</span> shape<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nW <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>random_normal<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span><span class=\"token string\">'weight'</span><span class=\"token punctuation\">)</span>\nb <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>random_normal<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span><span class=\"token string\">'bias'</span><span class=\"token punctuation\">)</span>\n\nhypothesis <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>matmul<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">,</span> W<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> b\ncost <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>reduce_mean<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>square<span class=\"token punctuation\">(</span>hypothesis <span class=\"token operator\">-</span> Y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Minimize</span>\noptimizer <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>train<span class=\"token punctuation\">.</span>GradientDescentOptimizer<span class=\"token punctuation\">(</span>learning_rate<span class=\"token operator\">=</span><span class=\"token number\">1e-5</span><span class=\"token punctuation\">)</span>\ntrain <span class=\"token operator\">=</span> optimizer<span class=\"token punctuation\">.</span>minimize<span class=\"token punctuation\">(</span>cost<span class=\"token punctuation\">)</span>\n\nsess <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Session<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nsess<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>global_variables_initializer<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">for</span> step <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">201</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    cost_val<span class=\"token punctuation\">,</span> hy_val<span class=\"token punctuation\">,</span> _ <span class=\"token operator\">=</span> sess<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>\n        <span class=\"token punctuation\">[</span>cost<span class=\"token punctuation\">,</span> hypothesis<span class=\"token punctuation\">,</span> train<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> feed_dict<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>X<span class=\"token punctuation\">:</span> x_data<span class=\"token punctuation\">,</span> Y<span class=\"token punctuation\">:</span> y_data<span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">if</span> step <span class=\"token operator\">%</span> <span class=\"token number\">40</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>step<span class=\"token punctuation\">,</span> <span class=\"token string\">\"Cost :\"</span><span class=\"token punctuation\">,</span> cost_val<span class=\"token punctuation\">,</span>\n             <span class=\"token string\">\"\\nPrediction\\n\"</span><span class=\"token punctuation\">,</span> hy_val<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">0 Cost : 272062040000.0\nPrediction\n [[-367724.94]\n [-739115.9 ]\n [-581670.8 ]\n [-408077.16]\n [-480746.12]\n [-484782.1 ]\n [-444402.88]\n [-565508.5 ]]\n40 Cost : nan\nPrediction\n [[nan]\n [nan]\n [nan]\n [nan]\n [nan]\n [nan]\n [nan]\n [nan]]\n80 Cost : nan\nPrediction\n [[nan]\n [nan]\n [nan]\n [nan]\n [nan]\n [nan]\n [nan]\n [nan]]\n120 Cost : nan\nPrediction\n [[nan]\n [nan]\n [nan]\n [nan]\n [nan]\n [nan]\n [nan]\n [nan]]\n160 Cost : nan\nPrediction\n [[nan]\n [nan]\n [nan]\n [nan]\n [nan]\n [nan]\n [nan]\n [nan]]\n200 Cost : nan\nPrediction\n [[nan]\n [nan]\n [nan]\n [nan]\n [nan]\n [nan]\n [nan]\n [nan]]</code></pre></div>\n<p>예측이 잘 되지않은 이유는 데이터가 <strong>Normalized</strong>되지 않았기 때문이다.</p>\n<h2 id=\"normalized-inputs-min-max-scale\" style=\"position:relative;\"><a href=\"#normalized-inputs-min-max-scale\" aria-label=\"normalized inputs min max scale permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Normalized inputs (min-max scale)</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">min_max_scaler</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    numerator <span class=\"token operator\">=</span> data <span class=\"token operator\">-</span> np<span class=\"token punctuation\">.</span><span class=\"token builtin\">min</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n    denominator <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span><span class=\"token builtin\">max</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> np<span class=\"token punctuation\">.</span><span class=\"token builtin\">min</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># noise term prevents the zero division</span>\n    <span class=\"token keyword\">return</span> numerator <span class=\"token operator\">/</span> <span class=\"token punctuation\">(</span>denominator <span class=\"token operator\">+</span> <span class=\"token number\">1e-7</span><span class=\"token punctuation\">)</span>\n\nxy <span class=\"token operator\">=</span> min_max_scaler<span class=\"token punctuation\">(</span>xy<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>xy<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">[[0.99999999 0.99999999 0.         1.         1.        ]\n [0.70548491 0.70439552 1.         0.71881782 0.83755791]\n [0.54412549 0.50274824 0.57608696 0.606468   0.6606331 ]\n [0.33890353 0.31368023 0.10869565 0.45989134 0.43800918]\n [0.51436    0.42582389 0.30434783 0.58504805 0.42624401]\n [0.49556179 0.42582389 0.31521739 0.48131134 0.49276137]\n [0.11436064 0.         0.20652174 0.22007776 0.18597238]\n [0.         0.07747099 0.5326087  0.         0.        ]]</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">x_data <span class=\"token operator\">=</span> xy<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\ny_data <span class=\"token operator\">=</span> xy<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\"># Placeholder for a tensor that will be always frd.</span>\nX <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>placeholder<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>float32<span class=\"token punctuation\">,</span> shape<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nY <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>placeholder<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>float32<span class=\"token punctuation\">,</span> shape<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nW <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>random_normal<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span><span class=\"token string\">'weight'</span><span class=\"token punctuation\">)</span>\nb <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>random_normal<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span><span class=\"token string\">'bias'</span><span class=\"token punctuation\">)</span>\n\nhypothesis <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>matmul<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">,</span> W<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> b\ncost <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>reduce_mean<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>square<span class=\"token punctuation\">(</span>hypothesis <span class=\"token operator\">-</span> Y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Minimize</span>\noptimizer <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>train<span class=\"token punctuation\">.</span>GradientDescentOptimizer<span class=\"token punctuation\">(</span>learning_rate<span class=\"token operator\">=</span><span class=\"token number\">1e-5</span><span class=\"token punctuation\">)</span>\ntrain <span class=\"token operator\">=</span> optimizer<span class=\"token punctuation\">.</span>minimize<span class=\"token punctuation\">(</span>cost<span class=\"token punctuation\">)</span>\n\nsess <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Session<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nsess<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>global_variables_initializer<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">for</span> step <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">201</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    cost_val<span class=\"token punctuation\">,</span> hy_val<span class=\"token punctuation\">,</span> _ <span class=\"token operator\">=</span> sess<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>\n        <span class=\"token punctuation\">[</span>cost<span class=\"token punctuation\">,</span> hypothesis<span class=\"token punctuation\">,</span> train<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> feed_dict<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>X<span class=\"token punctuation\">:</span> x_data<span class=\"token punctuation\">,</span> Y<span class=\"token punctuation\">:</span> y_data<span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">if</span> step <span class=\"token operator\">%</span> <span class=\"token number\">40</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>step<span class=\"token punctuation\">,</span> <span class=\"token string\">\"Cost :\"</span><span class=\"token punctuation\">,</span> cost_val<span class=\"token punctuation\">,</span>\n             <span class=\"token string\">\"\\nPrediction\\n\"</span><span class=\"token punctuation\">,</span> hy_val<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">0 Cost : 2.1135879\nPrediction\n [[-0.8375394 ]\n [-1.6286453 ]\n [-1.1022344 ]\n [-0.44793546]\n [-0.832747  ]\n [-0.7305834 ]\n [-0.39647448]\n [-0.3694872 ]]\n40 Cost : 2.1074905\nPrediction\n [[-0.83465135]\n [-1.6258268 ]\n [-1.099904  ]\n [-0.44615546]\n [-0.83062065]\n [-0.72853124]\n [-0.39512596]\n [-0.36815533]]\n80 Cost : 2.101407\nPrediction\n [[-0.83176506]\n [-1.6230099 ]\n [-1.0975752 ]\n [-0.44437712]\n [-0.8284959 ]\n [-0.7264808 ]\n [-0.39377916]\n [-0.36682522]]\n120 Cost : 2.0953507\nPrediction\n [[-0.82888675]\n [-1.620203  ]\n [-1.0952536 ]\n [-0.4426031 ]\n [-0.82637715]\n [-0.72443604]\n [-0.39243543]\n [-0.36549872]]\n160 Cost : 2.0893104\nPrediction\n [[-0.8260109 ]\n [-1.6173992 ]\n [-1.0929348 ]\n [-0.44083124]\n [-0.8242608 ]\n [-0.72239375]\n [-0.39109373]\n [-0.3641746 ]]\n200 Cost : 2.0832868\nPrediction\n [[-0.8231386 ]\n [-1.6145985 ]\n [-1.0906188 ]\n [-0.4390618 ]\n [-0.82214713]\n [-0.7203541 ]\n [-0.3897541 ]\n [-0.3628522 ]]</code></pre></div>\n<p>같은 데이터를 <strong>MinMax Scaler</strong>에 넣어 <strong>정규화(Normalized)</strong>한 후<br/>\n사용하니 값이 예측되는 것을 확인할 수 있다.</p>","frontmatter":{"title":"lab:training/test dataset, learning rate, normalization","date":"May 02, 2019","thumbnail":null}}},"pageContext":{"slug":"/MachineLearning/2019-05-02-BasicChapter8-3/","previous":{"fields":{"slug":"/MachineLearning/2019-05-01-BasicChapter8-2/"},"frontmatter":{"title":"Training/Testing 데이타 셋","category":"Machine Learning","draft":false}},"next":{"fields":{"slug":"/MachineLearning/2019-05-04-BasicChapter8-4/"},"frontmatter":{"title":"lab:Meet MNIST Dataset","category":"Machine Learning","draft":false}}}},"staticQueryHashes":["3001444076","3128451518"]}