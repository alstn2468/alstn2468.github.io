{"componentChunkName":"component---src-templates-blog-post-js","path":"/MachineLearning/2019-06-03-BasicChapter11-5-NN-Dropout","result":{"data":{"site":{"siteMetadata":{"title":"Minsu's Dev Log","author":"Minsu Kim","siteUrl":"https://alstn2468.github.io","comment":{"disqusShortName":"","utterances":"alstn2468/alstn2468.github.io"},"sponsor":{"buyMeACoffeeId":"eMLdEwU"}}},"markdownRemark":{"id":"3cafc729-b48c-559c-bd2c-045ba6e4ea5f","excerpt":"해당 게시물은 Edwith에서 제공하는\n머신러닝과 딥러닝 BASIC을 듣고 요약 정리한 글입니다. 사용할 모듈 추가 MNIST 데이터 불러오기 상수 정의 입력값 placeholder 선언 keep_prob 선언 부터는 keep_prob를 사용한다.\n이것은 전체 네트워크중 몇 퍼센트를 keep할 것인지 결정한다.\n학습과정에서는 0.5 ~ 0.7정도의 수치를 keep하고\n테스트과정에서는 반드시 전체(1)를 keep해야 한다.\n따라서 keep_prob를 로 선언한다. Neural Network…","html":"<p>해당 게시물은 <a href=\"https://www.edwith.org\">Edwith</a>에서 제공하는<br/>\n<a href=\"https://www.edwith.org/others26/joinLectures/9829\">머신러닝과 딥러닝 BASIC</a>을 듣고 요약 정리한 글입니다.</p>\n<h2 id=\"사용할-모듈-추가\" style=\"position:relative;\"><a href=\"#%EC%82%AC%EC%9A%A9%ED%95%A0-%EB%AA%A8%EB%93%88-%EC%B6%94%EA%B0%80\" aria-label=\"사용할 모듈 추가 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>사용할 모듈 추가</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> tensorflow <span class=\"token keyword\">as</span> tf\n<span class=\"token keyword\">import</span> matplotlib<span class=\"token punctuation\">.</span>pyplot <span class=\"token keyword\">as</span> plt\n<span class=\"token keyword\">import</span> random</code></pre></div>\n<h2 id=\"mnist-데이터-불러오기\" style=\"position:relative;\"><a href=\"#mnist-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%B6%88%EB%9F%AC%EC%98%A4%EA%B8%B0\" aria-label=\"mnist 데이터 불러오기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MNIST 데이터 불러오기</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> tensorflow<span class=\"token punctuation\">.</span>examples<span class=\"token punctuation\">.</span>tutorials<span class=\"token punctuation\">.</span>mnist <span class=\"token keyword\">import</span> input_data\n\nmnist <span class=\"token operator\">=</span> input_data<span class=\"token punctuation\">.</span>read_data_sets<span class=\"token punctuation\">(</span><span class=\"token string\">\"MNIST_data/\"</span><span class=\"token punctuation\">,</span> one_hot<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2 id=\"상수-정의\" style=\"position:relative;\"><a href=\"#%EC%83%81%EC%88%98-%EC%A0%95%EC%9D%98\" aria-label=\"상수 정의 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>상수 정의</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">learning_rate <span class=\"token operator\">=</span> <span class=\"token number\">0.001</span>\ntraining_epochs <span class=\"token operator\">=</span> <span class=\"token number\">15</span>\nbatch_size <span class=\"token operator\">=</span> <span class=\"token number\">100</span>\ntotal_batch <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>mnist<span class=\"token punctuation\">.</span>train<span class=\"token punctuation\">.</span>num_examples <span class=\"token operator\">/</span> batch_size<span class=\"token punctuation\">)</span></code></pre></div>\n<h2 id=\"입력값-placeholder-선언\" style=\"position:relative;\"><a href=\"#%EC%9E%85%EB%A0%A5%EA%B0%92-placeholder-%EC%84%A0%EC%96%B8\" aria-label=\"입력값 placeholder 선언 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>입력값 placeholder 선언</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">X <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>placeholder<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>float32<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">784</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nY <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>placeholder<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>float32<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2 id=\"keep_prob-선언\" style=\"position:relative;\"><a href=\"#keep_prob-%EC%84%A0%EC%96%B8\" aria-label=\"keep_prob 선언 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>keep_prob 선언</h2>\n<p><code class=\"language-text\">tensorflow 1.0</code>부터는 <strong>keep_prob</strong>를 사용한다.<br/>\n이것은 전체 네트워크중 몇 퍼센트를 <strong>keep</strong>할 것인지 결정한다.<br/>\n<strong>학습</strong>과정에서는 <strong>0.5 ~ 0.7</strong>정도의 수치를 <strong>keep</strong>하고<br/>\n<strong>테스트</strong>과정에서는 반드시 전체(<strong>1</strong>)를 <strong>keep</strong>해야 한다.<br/>\n따라서 <strong>keep_prob</strong>를 <code class=\"language-text\">placeholder</code>로 선언한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">keep_prob <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>placeholder<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>float32<span class=\"token punctuation\">)</span></code></pre></div>\n<h2 id=\"neural-network-layer-구성\" style=\"position:relative;\"><a href=\"#neural-network-layer-%EA%B5%AC%EC%84%B1\" aria-label=\"neural network layer 구성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Neural Network Layer 구성</h2>\n<p><strong>Drop Out</strong>을 사용할 하나의 Layer를 추가로 구성하면 된다.<br/></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">W1 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>get_variable<span class=\"token punctuation\">(</span><span class=\"token string\">\"W1\"</span><span class=\"token punctuation\">,</span> shape<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token number\">784</span><span class=\"token punctuation\">,</span> <span class=\"token number\">512</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                     initializer<span class=\"token operator\">=</span>tf<span class=\"token punctuation\">.</span>contrib<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>xavier_initializer<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nb1 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>random_normal<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">512</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nL1 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>nn<span class=\"token punctuation\">.</span>relu<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>matmul<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">,</span> W1<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> b1<span class=\"token punctuation\">)</span>\nL1 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>nn<span class=\"token punctuation\">.</span>dropout<span class=\"token punctuation\">(</span>L1<span class=\"token punctuation\">,</span> keep_prob<span class=\"token operator\">=</span>keep_prob<span class=\"token punctuation\">)</span>\n\nW2 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>get_variable<span class=\"token punctuation\">(</span><span class=\"token string\">\"W2\"</span><span class=\"token punctuation\">,</span> shape<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token number\">512</span><span class=\"token punctuation\">,</span> <span class=\"token number\">512</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                     initializer<span class=\"token operator\">=</span>tf<span class=\"token punctuation\">.</span>contrib<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>xavier_initializer<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nb2 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>random_normal<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">512</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nL2 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>nn<span class=\"token punctuation\">.</span>relu<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>matmul<span class=\"token punctuation\">(</span>L1<span class=\"token punctuation\">,</span> W2<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> b2<span class=\"token punctuation\">)</span>\nL2 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>nn<span class=\"token punctuation\">.</span>dropout<span class=\"token punctuation\">(</span>L2<span class=\"token punctuation\">,</span> keep_prob<span class=\"token operator\">=</span>keep_prob<span class=\"token punctuation\">)</span>\n\nW3 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>get_variable<span class=\"token punctuation\">(</span><span class=\"token string\">\"W3\"</span><span class=\"token punctuation\">,</span> shape<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token number\">512</span><span class=\"token punctuation\">,</span> <span class=\"token number\">512</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                     initializer<span class=\"token operator\">=</span>tf<span class=\"token punctuation\">.</span>contrib<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>xavier_initializer<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nb3 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>random_normal<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">512</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nL3 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>nn<span class=\"token punctuation\">.</span>relu<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>matmul<span class=\"token punctuation\">(</span>L2<span class=\"token punctuation\">,</span> W3<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> b3<span class=\"token punctuation\">)</span>\nL3 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>nn<span class=\"token punctuation\">.</span>dropout<span class=\"token punctuation\">(</span>L3<span class=\"token punctuation\">,</span> keep_prob<span class=\"token operator\">=</span>keep_prob<span class=\"token punctuation\">)</span>\n\nW4 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>get_variable<span class=\"token punctuation\">(</span><span class=\"token string\">\"W4\"</span><span class=\"token punctuation\">,</span> shape<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token number\">512</span><span class=\"token punctuation\">,</span> <span class=\"token number\">512</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                     initializer<span class=\"token operator\">=</span>tf<span class=\"token punctuation\">.</span>contrib<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>xavier_initializer<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nb4 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>random_normal<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">512</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nL4 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>nn<span class=\"token punctuation\">.</span>relu<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>matmul<span class=\"token punctuation\">(</span>L3<span class=\"token punctuation\">,</span> W4<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> b4<span class=\"token punctuation\">)</span>\nL4 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>nn<span class=\"token punctuation\">.</span>dropout<span class=\"token punctuation\">(</span>L4<span class=\"token punctuation\">,</span> keep_prob<span class=\"token operator\">=</span>keep_prob<span class=\"token punctuation\">)</span>\n\nW5 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>get_variable<span class=\"token punctuation\">(</span><span class=\"token string\">\"W5\"</span><span class=\"token punctuation\">,</span> shape<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token number\">512</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                     initializer<span class=\"token operator\">=</span>tf<span class=\"token punctuation\">.</span>contrib<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>xavier_initializer<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nb5 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>random_normal<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nhypothesis <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>matmul<span class=\"token punctuation\">(</span>L4<span class=\"token punctuation\">,</span> W5<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> b5</code></pre></div>\n<h2 id=\"손실함수와-최적화-방법-정의\" style=\"position:relative;\"><a href=\"#%EC%86%90%EC%8B%A4%ED%95%A8%EC%88%98%EC%99%80-%EC%B5%9C%EC%A0%81%ED%99%94-%EB%B0%A9%EB%B2%95-%EC%A0%95%EC%9D%98\" aria-label=\"손실함수와 최적화 방법 정의 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>손실함수와 최적화 방법 정의</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">cost <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>reduce_mean<span class=\"token punctuation\">(</span>\n    tf<span class=\"token punctuation\">.</span>nn<span class=\"token punctuation\">.</span>softmax_cross_entropy_with_logits_v2<span class=\"token punctuation\">(</span>logits<span class=\"token operator\">=</span>hypothesis<span class=\"token punctuation\">,</span> labels<span class=\"token operator\">=</span>Y<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span>\noptimizer <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>train<span class=\"token punctuation\">.</span>AdamOptimizer<span class=\"token punctuation\">(</span>learning_rate<span class=\"token operator\">=</span>learning_rate<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>minimize<span class=\"token punctuation\">(</span>cost<span class=\"token punctuation\">)</span></code></pre></div>\n<h2 id=\"session-초기화\" style=\"position:relative;\"><a href=\"#session-%EC%B4%88%EA%B8%B0%ED%99%94\" aria-label=\"session 초기화 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Session 초기화</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">sess <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Session<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nsess<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>global_variables_initializer<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2 id=\"모델-학습-진행\" style=\"position:relative;\"><a href=\"#%EB%AA%A8%EB%8D%B8-%ED%95%99%EC%8A%B5-%EC%A7%84%ED%96%89\" aria-label=\"모델 학습 진행 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>모델 학습 진행</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">for</span> epoch <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>training_epochs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    avg_cost <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n\n    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>total_batch<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        batch_xs<span class=\"token punctuation\">,</span> batch_ys <span class=\"token operator\">=</span> mnist<span class=\"token punctuation\">.</span>train<span class=\"token punctuation\">.</span>next_batch<span class=\"token punctuation\">(</span>batch_size<span class=\"token punctuation\">)</span>\n        feed_dict <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>X<span class=\"token punctuation\">:</span> batch_xs<span class=\"token punctuation\">,</span> Y<span class=\"token punctuation\">:</span> batch_ys<span class=\"token punctuation\">,</span> keep_prob<span class=\"token punctuation\">:</span> <span class=\"token number\">0.7</span><span class=\"token punctuation\">}</span>\n        c<span class=\"token punctuation\">,</span> _ <span class=\"token operator\">=</span> sess<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>cost<span class=\"token punctuation\">,</span> optimizer<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> feed_dict<span class=\"token operator\">=</span>feed_dict<span class=\"token punctuation\">)</span>\n        avg_cost <span class=\"token operator\">+=</span> c <span class=\"token operator\">/</span> total_batch\n\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Epoch:'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'%04d'</span> <span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span>epoch <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'cost ='</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'{:.9f}'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>avg_cost<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Learning Finished!'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Epoch: 0001 cost = 0.468633001\nEpoch: 0002 cost = 0.170478383\nEpoch: 0003 cost = 0.131077586\nEpoch: 0004 cost = 0.108677959\nEpoch: 0005 cost = 0.096312569\nEpoch: 0006 cost = 0.082181592\nEpoch: 0007 cost = 0.078254419\nEpoch: 0008 cost = 0.069326370\nEpoch: 0009 cost = 0.062080975\nEpoch: 0010 cost = 0.055655396\nEpoch: 0011 cost = 0.057310239\nEpoch: 0012 cost = 0.055785087\nEpoch: 0013 cost = 0.052270090\nEpoch: 0014 cost = 0.048582647\nEpoch: 0015 cost = 0.044075073\nLearning Finished!</code></pre></div>\n<h2 id=\"모델-테스트-및-정확도-확인\" style=\"position:relative;\"><a href=\"#%EB%AA%A8%EB%8D%B8-%ED%85%8C%EC%8A%A4%ED%8A%B8-%EB%B0%8F-%EC%A0%95%ED%99%95%EB%8F%84-%ED%99%95%EC%9D%B8\" aria-label=\"모델 테스트 및 정확도 확인 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>모델 테스트 및 정확도 확인</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">correct_prediction <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>equal<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>argmax<span class=\"token punctuation\">(</span>hypothesis<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> tf<span class=\"token punctuation\">.</span>argmax<span class=\"token punctuation\">(</span>Y<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\naccuracy <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>reduce_mean<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>cast<span class=\"token punctuation\">(</span>correct_prediction<span class=\"token punctuation\">,</span> tf<span class=\"token punctuation\">.</span>float32<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>\n    <span class=\"token string\">'Accuracy:'</span><span class=\"token punctuation\">,</span>\n    sess<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>\n        accuracy<span class=\"token punctuation\">,</span>\n        feed_dict<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>\n            X<span class=\"token punctuation\">:</span> mnist<span class=\"token punctuation\">.</span>test<span class=\"token punctuation\">.</span>images<span class=\"token punctuation\">,</span>\n            Y<span class=\"token punctuation\">:</span> mnist<span class=\"token punctuation\">.</span>test<span class=\"token punctuation\">.</span>labels<span class=\"token punctuation\">,</span>\n            keep_prob<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Accuracy: 0.9813</code></pre></div>\n<p><strong>Drop out</strong>을 사용한 결과 <strong>97%</strong>의 정확도에서<br/>\n<strong>98%</strong>까지의 정확도 까지 올리는데에 성공하였다.<br/></p>\n<h2 id=\"임의의-정수-예측하기\" style=\"position:relative;\"><a href=\"#%EC%9E%84%EC%9D%98%EC%9D%98-%EC%A0%95%EC%88%98-%EC%98%88%EC%B8%A1%ED%95%98%EA%B8%B0\" aria-label=\"임의의 정수 예측하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>임의의 정수 예측하기</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">r <span class=\"token operator\">=</span> random<span class=\"token punctuation\">.</span>randint<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> mnist<span class=\"token punctuation\">.</span>test<span class=\"token punctuation\">.</span>num_examples <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Label: \"</span><span class=\"token punctuation\">,</span> sess<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>argmax<span class=\"token punctuation\">(</span>mnist<span class=\"token punctuation\">.</span>test<span class=\"token punctuation\">.</span>labels<span class=\"token punctuation\">[</span>r<span class=\"token punctuation\">:</span>r<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>\n    <span class=\"token string\">\"Prediction: \"</span><span class=\"token punctuation\">,</span>\n    sess<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>\n        tf<span class=\"token punctuation\">.</span>argmax<span class=\"token punctuation\">(</span>hypothesis<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        feed_dict<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>X<span class=\"token punctuation\">:</span> mnist<span class=\"token punctuation\">.</span>test<span class=\"token punctuation\">.</span>images<span class=\"token punctuation\">[</span>r<span class=\"token punctuation\">:</span>r<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> keep_prob<span class=\"token punctuation\">:</span><span class=\"token number\">1</span><span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Label:  [6]\nPrediction:  [6]</code></pre></div>\n<h2 id=\"예측한-정수-그리기\" style=\"position:relative;\"><a href=\"#%EC%98%88%EC%B8%A1%ED%95%9C-%EC%A0%95%EC%88%98-%EA%B7%B8%EB%A6%AC%EA%B8%B0\" aria-label=\"예측한 정수 그리기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>예측한 정수 그리기</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">plt<span class=\"token punctuation\">.</span>imshow<span class=\"token punctuation\">(</span>\n    mnist<span class=\"token punctuation\">.</span>test<span class=\"token punctuation\">.</span>images<span class=\"token punctuation\">[</span>r<span class=\"token punctuation\">:</span>r <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token number\">28</span><span class=\"token punctuation\">,</span> <span class=\"token number\">28</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    cmap<span class=\"token operator\">=</span><span class=\"token string\">'Greys'</span><span class=\"token punctuation\">,</span> interpolation<span class=\"token operator\">=</span><span class=\"token string\">'nearest'</span>\n<span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 255px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 98.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAADMElEQVQ4y31US0hbQRSdtm5KY2mln5Ug0sbYmGoxlubZpAtxkVJdqytxo4gICiKiLkR068KNH0REUcEP+AE/+FcEQdSlKAiCguhCycdv8k7vHTPpS7ReGN6dO2/O3DP3zBVCiOdut/vtzMzMj8XFxcyFhQXtqTE3N6dNT09ra2tr2urqqjY/P68tLS1x7GdnZ2esACDq6uocPp/PHwwGcXd3999xe3srv2w3Nze4urqSc97n8Xiwubmpiba2NrG+vv6JFr24tyANPXqwKb+rq0vPzc3Vt7a2VCzI4Ds7O5rMkEBTLy8vJSDtC+oG4xBlEAZrbm7WzWaz3tLSonu93jAg7cf29rYm2BobG7+rDEOAuMeCpBOKo6qqCjk5OSBGUBY67B9gQ0ODoGJ8poDPCGgE43sqLCxEQUGBvCsVCx38IMPnPT09KcYMVUZq5OXlwW63w+/3R4M9CviBKV9fX3seo1xSUgKXy4Xj42M550oHAgE5mMEDwOrqakFaMhsp889s7e3tsFgsODs7wxMWCchVHhwc/KIAg6GLW15eRkJCAoaHh+Wu8/NzbGxsgCSD8vJyVFRUgETO9B9Q/tjU1JRhpMxfvjdaA2UvMyXxo7KyEsXFxUhLS5Nr8fHxODw8lID0MO4BR0ZGxNTUVJLSIS9eXFzITTExMaDscXBwAI4p43lcXBysVitfhwTkgoUpE61k40vh05xOp8wiPz8fu7u7ssJHR0cYGBhAdnY2EhMTsbKyEiKlR1B+T1RcirK6w9nZWdhsNglqMpngcDhQVFQEaiSora3F3t6eEnzkHU5OTorx8XHLY8I+OTnB0NAQ+vv7Qf/h9PQ0LHaDViMBe3t7GTTJ+Jaj32/0IFnJdcN7j6D8rqamJpPakcegq3AGUSKOyM7wv86A4W5DtJI5Q96kNqs+x6cr0Cg/wN9QfwxwIakfZgoqvcjKyoqlF+OkrptCrcxeX1//i6RkpQ6cXlpa+nt0dNTW3d39rayszE1VTiVVfKUn+aejoyN9bGwsheOtra0ZNH8pQvaCmwRlKjMme9bX16f81xMTE8p/RXoUJCP233Bsf3+ffRP7pBbxF1gS49xGnV2NAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"아직 안만듬\" title=\"아직 안만듬\" src=\"/static/f657c126f576c3c0898909b868c8a056/b8c8f/4.png\" srcset=\"/static/f657c126f576c3c0898909b868c8a056/8a4e8/4.png 150w,\n/static/f657c126f576c3c0898909b868c8a056/b8c8f/4.png 255w\" sizes=\"(max-width: 255px) 100vw, 255px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span><br/></p>\n<h2 id=\"optimizer\" style=\"position:relative;\"><a href=\"#optimizer\" aria-label=\"optimizer permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Optimizer</h2>\n<p>여러가지의 <strong>Optimizer</strong>가 존재하지만 여러가지를<br/>\n테스트해서 사용하는 것이 좋지만 통상적으로 <strong>Adam</strong>으로 시작하는것이 좋다.<br/></p>","frontmatter":{"title":"Drop Out을 사용해 MNIST 정확도 높이기","date":"June 03, 2019","thumbnail":null}}},"pageContext":{"slug":"/MachineLearning/2019-06-03-BasicChapter11-5-NN-Dropout/","previous":{"fields":{"slug":"/MachineLearning/2019-06-03-BasicChapter11-5-NN-Deep/"},"frontmatter":{"title":"깊고 넓은 NN으로 MNIST 학습하기","category":"Machine Learning","draft":false}},"next":{"fields":{"slug":"/MachineLearning/2019-06-06-BasicChapter12-1/"},"frontmatter":{"title":"ConvNet의 Conv 레이어 만들기","category":"Machine Learning","draft":false}}}},"staticQueryHashes":["3001444076","3128451518"]}