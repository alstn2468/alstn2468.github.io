{"componentChunkName":"component---src-templates-blog-post-js","path":"/MachineLearning/2019-05-23-BasicChapter11-1","result":{"data":{"site":{"siteMetadata":{"title":"Minsu's Dev Log","author":"Minsu Kim","siteUrl":"https://alstn2468.github.io","comment":{"disqusShortName":"","utterances":"alstn2468/alstn2468.github.io"},"sponsor":{"buyMeACoffeeId":"eMLdEwU"}}},"markdownRemark":{"id":"a1dd72dd-d57c-5383-8903-11bd80778f43","excerpt":"해당 게시물은 Edwith에서 제공하는\n머신러닝과 딥러닝 BASIC을 듣고 요약 정리한 글입니다. 활성화 함수 각 Unit 끝의 함수를 Activation function이라고 한다.\n활성화 함수는 출력값이 어떤 값보다 크면 작동하고\n어떤 값보다 작으면 작동하지 않는 함수를 의미한다. Neural Network for XOR 입력값은 공통적으로 ,  2개이므로\n첫번째 Layer의 크기는 이 되어야하고 출력값은\n 하나이므로 마지막 Layer의 크기는 이 되어야한다. 2개의 Layer를 갖는 NN…","html":"<p>해당 게시물은 <a href=\"https://www.edwith.org\">Edwith</a>에서 제공하는<br/>\n<a href=\"https://www.edwith.org/others26/joinLectures/9829\">머신러닝과 딥러닝 BASIC</a>을 듣고 요약 정리한 글입니다.</p>\n<h2 id=\"활성화-함수\" style=\"position:relative;\"><a href=\"#%ED%99%9C%EC%84%B1%ED%99%94-%ED%95%A8%EC%88%98\" aria-label=\"활성화 함수 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>활성화 함수</h2>\n<p>각 Unit 끝의 함수를 <strong>Activation function</strong>이라고 한다.<br/>\n<strong>활성화 함수</strong>는 출력값이 어떤 값보다 크면 작동하고<br/>\n어떤 값보다 작으면 작동하지 않는 함수를 의미한다.</p>\n<h2 id=\"neural-network-for-xor\" style=\"position:relative;\"><a href=\"#neural-network-for-xor\" aria-label=\"neural network for xor permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Neural Network for XOR</h2>\n<p>입력값은 공통적으로 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>X</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">X_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>, <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>X</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">X_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 2개이므로<br/>\n첫번째 Layer의 크기는 <code class=\"language-text\">[2, n]</code>이 되어야하고 출력값은<br/>\n<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi>Y</mi><mo>ˉ</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\bar{Y}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8201em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8201em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span></span><span style=\"top:-3.2523em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.25em;\"><span class=\"mord\">ˉ</span></span></span></span></span></span></span></span></span></span> 하나이므로 마지막 Layer의 크기는 <code class=\"language-text\">[m, 1]</code>이 되어야한다.</p>\n<p>2개의 Layer를 갖는 NN의 기본적인 구성<br/>\n2개의 <strong>Weight</strong>, <strong>Bias</strong>, <strong>Sigmoid Function</strong>으로 구성</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">W1 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>random_uniform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nW2 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>random_uniform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nb1 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span><span class=\"token string\">\"Bias1\"</span><span class=\"token punctuation\">)</span>\nb2 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span><span class=\"token string\">\"Bias2\"</span><span class=\"token punctuation\">)</span>\n\nL2 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>sigmoid<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>matmul<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">,</span> W1<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> b<span class=\"token punctuation\">)</span>\nhypothesis <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>sigmoid<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>matmul<span class=\"token punctuation\">(</span>L2<span class=\"token punctuation\">,</span> W2<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> b2<span class=\"token punctuation\">)</span></code></pre></div>\n<p>3개의 Layer를 갖는 NN의 기본적인 구성<br/>\n3개의 <strong>Weight</strong>, <strong>Bias</strong>, <strong>Sigmoid Function</strong>으로 구성</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">W1 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>random_uniform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nW2 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>random_uniform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nW3 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>random_uniform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nb1 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span><span class=\"token string\">\"Bias1\"</span><span class=\"token punctuation\">)</span>\nb2 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span><span class=\"token string\">\"Bias2\"</span><span class=\"token punctuation\">)</span>\nb3 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span><span class=\"token string\">\"Bias3\"</span><span class=\"token punctuation\">)</span>\n\nL2 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>sigmoid<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>matmul<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">,</span> W1<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> b1<span class=\"token punctuation\">)</span>\nL3 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>sigmoid<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>matmul<span class=\"token punctuation\">(</span>L2<span class=\"token punctuation\">,</span> W2<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> b2<span class=\"token punctuation\">)</span>\nhypothesis <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>sigmoid<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>matmul<span class=\"token punctuation\">(</span>L3<span class=\"token punctuation\">,</span> W3<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> b3<span class=\"token punctuation\">)</span></code></pre></div>\n<p>안쪽에 보이지 않은 Layer를 <strong>Hidden Layer</strong>라고 한다.</p>\n<h3 id=\"9개의-hidden-layer\" style=\"position:relative;\"><a href=\"#9%EA%B0%9C%EC%9D%98-hidden-layer\" aria-label=\"9개의 hidden layer permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>9개의 Hidden Layer</h3>\n<p><strong>Input Layer</strong> : <code class=\"language-text\">W1</code><br/>\n<strong>Hidden Layer</strong> : <code class=\"language-text\">W2</code> ~ <code class=\"language-text\">W10</code><br/>\n<strong>Output Layer</strong> : <code class=\"language-text\">W11</code></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">W1 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>random_uniform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">)</span> name<span class=\"token operator\">=</span><span class=\"token string\">\"Weight1\"</span><span class=\"token punctuation\">)</span>\n\nW2 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>random_uniform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">)</span> name<span class=\"token operator\">=</span><span class=\"token string\">\"Weight2\"</span><span class=\"token punctuation\">)</span>\nW3 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>random_uniform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">)</span> name<span class=\"token operator\">=</span><span class=\"token string\">\"Weight3\"</span><span class=\"token punctuation\">)</span>\nW4 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>random_uniform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">)</span> name<span class=\"token operator\">=</span><span class=\"token string\">\"Weight4\"</span><span class=\"token punctuation\">)</span>\nW5 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>random_uniform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">)</span> name<span class=\"token operator\">=</span><span class=\"token string\">\"Weight5\"</span><span class=\"token punctuation\">)</span>\nW6 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>random_uniform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">)</span> name<span class=\"token operator\">=</span><span class=\"token string\">\"Weight6\"</span><span class=\"token punctuation\">)</span>\nW7 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>random_uniform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">)</span> name<span class=\"token operator\">=</span><span class=\"token string\">\"Weight7\"</span><span class=\"token punctuation\">)</span>\nW8 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>random_uniform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">)</span> name<span class=\"token operator\">=</span><span class=\"token string\">\"Weight8\"</span><span class=\"token punctuation\">)</span>\nW9 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>random_uniform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">)</span> name<span class=\"token operator\">=</span><span class=\"token string\">\"Weight9\"</span><span class=\"token punctuation\">)</span>\nW10 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>random_uniform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">)</span> name<span class=\"token operator\">=</span><span class=\"token string\">\"Weight10\"</span><span class=\"token punctuation\">)</span>\n\nW11 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>random_uniform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">)</span> name<span class=\"token operator\">=</span><span class=\"token string\">\"Weight11\"</span><span class=\"token punctuation\">)</span>\n\nb1 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>zeross<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span><span class=\"token string\">\"Bias1\"</span><span class=\"token punctuation\">)</span>\nb2 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>zeross<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span><span class=\"token string\">\"Bias2\"</span><span class=\"token punctuation\">)</span>\nb3 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>zeross<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span><span class=\"token string\">\"Bias3\"</span><span class=\"token punctuation\">)</span>\nb4 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>zeross<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span><span class=\"token string\">\"Bias4\"</span><span class=\"token punctuation\">)</span>\nb5 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>zeross<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span><span class=\"token string\">\"Bias5\"</span><span class=\"token punctuation\">)</span>\nb6 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>zeross<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span><span class=\"token string\">\"Bias6\"</span><span class=\"token punctuation\">)</span>\nb7 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>zeross<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span><span class=\"token string\">\"Bias7\"</span><span class=\"token punctuation\">)</span>\nb8 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>zeross<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span><span class=\"token string\">\"Bias8\"</span><span class=\"token punctuation\">)</span>\nb9 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>zeross<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span><span class=\"token string\">\"Bias9\"</span><span class=\"token punctuation\">)</span>\nb10 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>zeross<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span><span class=\"token string\">\"Bias10\"</span><span class=\"token punctuation\">)</span>\n\nb11 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Variable<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>zeross<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span><span class=\"token string\">\"Bias11\"</span><span class=\"token punctuation\">)</span>\n\nL1 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>sigmoid<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>matmul<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">,</span> W1<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> b1<span class=\"token punctuation\">)</span>\nL2 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>sigmoid<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>matmul<span class=\"token punctuation\">(</span>L1<span class=\"token punctuation\">,</span> W1<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> b2<span class=\"token punctuation\">)</span>\nL3 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>sigmoid<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>matmul<span class=\"token punctuation\">(</span>L2<span class=\"token punctuation\">,</span> W1<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> b3<span class=\"token punctuation\">)</span>\nL4 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>sigmoid<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>matmul<span class=\"token punctuation\">(</span>L3<span class=\"token punctuation\">,</span> W1<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> b4<span class=\"token punctuation\">)</span>\nL5 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>sigmoid<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>matmul<span class=\"token punctuation\">(</span>L4<span class=\"token punctuation\">,</span> W1<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> b5<span class=\"token punctuation\">)</span>\nL6 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>sigmoid<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>matmul<span class=\"token punctuation\">(</span>L5<span class=\"token punctuation\">,</span> W1<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> b6<span class=\"token punctuation\">)</span>\nL7 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>sigmoid<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>matmul<span class=\"token punctuation\">(</span>L6<span class=\"token punctuation\">,</span> W1<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> b7<span class=\"token punctuation\">)</span>\nL8 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>sigmoid<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>matmul<span class=\"token punctuation\">(</span>L7<span class=\"token punctuation\">,</span> W1<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> b8<span class=\"token punctuation\">)</span>\nL9 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>sigmoid<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>matmul<span class=\"token punctuation\">(</span>L8<span class=\"token punctuation\">,</span> W1<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> b9<span class=\"token punctuation\">)</span>\nL10 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>sigmoid<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>matmul<span class=\"token punctuation\">(</span>L9<span class=\"token punctuation\">,</span> W1<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> b10<span class=\"token punctuation\">)</span>\n\nhypothesis <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>sigmoid<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>matmul<span class=\"token punctuation\">(</span>L10<span class=\"token punctuation\">,</span> W1<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> b11<span class=\"token punctuation\">)</span></code></pre></div>\n<p>위와 예시는 11개의 Layer를 연결하였는데 위의 코드로<br/>\nXOR 문제를 학습시키고 예측을해도 좋은 결과를 얻기 힘들다.<br/>\n<strong>Backpropagation의 단점</strong>으로 많은 Layer를 사용하면<br/>\n학습결과가 좋지 않아 예측이 잘 되지않는다.<br/></p>\n<p>왜냐하면 <strong>Sigmoid</strong>를 통과하는 위의 Layer 특성상<br/>\n<strong>Chain Rule</strong>을 적용하게 되면 1보다 작은 값이 계속 곱해져<br/>\nNN의 맨 뒤에까지 가게 되면 <strong>0과 매우 가까운 값</strong>이 되는데<br/>\n이것은 Layer의 값들이 서로 <strong>미치는 영향</strong>이 거의 <strong>없다</strong>는 뜻이다.</p>\n<p>이것을 <strong>Vanishing Gradient</strong>라고 한다.<br/>\nLayer의 깊이가 깊어질수록 최종 Layer근처의 경사는 나타나지만<br/>\n뒤쪽 Layer근처의 경사는 사라지게 되는 문제다.<br/></p>\n<h2 id=\"vanishing-gradient의-해결\" style=\"position:relative;\"><a href=\"#vanishing-gradient%EC%9D%98-%ED%95%B4%EA%B2%B0\" aria-label=\"vanishing gradient의 해결 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vanishing Gradient의 해결</h2>\n<p><strong>Sigmoid Function</strong>이 <strong>Vanishing Gradient</strong>문제가 발생<br/>\n<strong>ReLU</strong>라는 <strong>Activation Function</strong> 사용으로 문제를 해결<br/>\n<strong>0보다 작을 경우 비활성화</strong> 하고 <strong>0보다 클 경우 값을 크게</strong> 한다.<br/></p>\n<p>아래의 그래프와 같이 동작한다.<br/>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 58.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABfElEQVQoz4VS226DMAzt/39RHzZtmtYHntanaqibVHHpjVsItEBCcuaEyxAbm4XlENknx8deYWZa6/HcNA3quoZSCks25A9xtZRgQLbbLRzHgeu69k5KiTRNkWUpGLlo6q6mbYfiZUATq6qCEAJRFKGlIikFPfKGh8dnvLw6ePciVMEZyBl0X7P6q43BeFFAtRJCakRMICsk6IM8XaCCYKzR/zEczmXBkbA7LmlNusouMYmACRj+0nDUsY+XmCG8lt85JIH2PNsm+nw91XDOagpqzD3ENADRPRLH0DNmA5hlOF7OQLqpKpzTBtcohW2UtAw3Gzyt1wg+P36QGFvWvVsG5KLVSAqBE2kmaCPKmqZNbcL3SQaFe5ZB3MpfpbIMtTAjk+D5HedrQWtSouQVIXdtctKr2e/tY6pv0bhZJePD4neABKTDwL7eHDyanA+Yf3Ltm3MIttshSRLknIMxNnqe59bNsge9ruOU9STqmQz8drNMlswwPB6P9vwFlv6pYxdl3PEAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"아직 안만듬\" title=\"아직 안만듬\" src=\"/static/8d161b6deeb6f1231f954fb1f1b0a1a2/0a47e/1.png\" srcset=\"/static/8d161b6deeb6f1231f954fb1f1b0a1a2/8a4e8/1.png 150w,\n/static/8d161b6deeb6f1231f954fb1f1b0a1a2/5a46d/1.png 300w,\n/static/8d161b6deeb6f1231f954fb1f1b0a1a2/0a47e/1.png 600w,\n/static/8d161b6deeb6f1231f954fb1f1b0a1a2/57dc1/1.png 718w\" sizes=\"(max-width: 600px) 100vw, 600px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span></p>\n<p><strong>ReLU</strong> (<strong>Re</strong>ctified <strong>L</strong>inear <strong>U</strong>nit)<br/>\n<code class=\"language-text\">tf.sigmoid</code>을 <code class=\"language-text\">tf.nn.relu</code>를 사용하면 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">L1 <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>nn<span class=\"token punctuation\">.</span>relu<span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>matmul<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">,</span> W1<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> b1<span class=\"token punctuation\">)</span></code></pre></div>\n<p>이전의 11단의 Layer로 XOR문제를 해결하려던 코드를<br/>\n<code class=\"language-text\">L1</code> ~ <code class=\"language-text\">L10</code>은 <strong>ReLu</strong>를 사용하고 마지막 레이어인<br/>\n<code class=\"language-text\">L11</code>만 <strong>Sigmoid</strong>를 사용해서 값을 학습시키면 잘 예측된다.<br/></p>\n<p><code class=\"language-text\">L11</code>만 <strong>Sigmoid</strong>를 사용하는 이유는<br/>\n<strong>마지막 단</strong>의 출력은 <strong>0 ~ 1의 출력</strong>을 얻어야하기 때문이다.</p>\n<h2 id=\"활성화-함수의-종류\" style=\"position:relative;\"><a href=\"#%ED%99%9C%EC%84%B1%ED%99%94-%ED%95%A8%EC%88%98%EC%9D%98-%EC%A2%85%EB%A5%98\" aria-label=\"활성화 함수의 종류 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>활성화 함수의 종류</h2>\n<ul>\n<li>Sigmoid</li>\n<li>tanh</li>\n<li>ReLU</li>\n<li>Leaky ReLU</li>\n<li>Maxout</li>\n<li>ELU</li>\n<li>etc</li>\n</ul>","frontmatter":{"title":"XSigmoid 보다 ReLU가 더 좋아","date":"May 23, 2019","thumbnail":null}}},"pageContext":{"slug":"/MachineLearning/2019-05-23-BasicChapter11-1/","previous":{"fields":{"slug":"/MachineLearning/2019-05-24-BasicChapter11-2/"},"frontmatter":{"title":"Weight를 잘 초기화 해보자","category":"Machine Learning","draft":false}},"next":{"fields":{"slug":"/MachineLearning/2019-05-29-BasicChapter11-3/"},"frontmatter":{"title":"Dropout 과 앙상블","category":"Machine Learning","draft":false}}}},"staticQueryHashes":["3001444076","3128451518"]}