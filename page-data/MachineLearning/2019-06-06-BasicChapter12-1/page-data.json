{"componentChunkName":"component---src-templates-blog-post-js","path":"/MachineLearning/2019-06-06-BasicChapter12-1","result":{"data":{"site":{"siteMetadata":{"title":"Minsu's Dev Log","author":"Minsu Kim","siteUrl":"https://alstn2468.github.io","comment":{"disqusShortName":"","utterances":"alstn2468/alstn2468.github.io"},"sponsor":{"buyMeACoffeeId":"eMLdEwU"}}},"markdownRemark":{"id":"254e85a0-350f-5838-9bc8-2926ff79b0d7","excerpt":"해당 게시물은 Edwith에서 제공하는\n머신러닝과 딥러닝 BASIC을 듣고 요약 정리한 글입니다. Convolutional Neural Network 고양이가 어떠한 사물을 볼때 뇌 전체가 아닌\n일부만 활성화 된다는 사실을 발견함에서 시작 기본적인 CNN의 구성으로 CONV와 RELU가 한 쌍으로 구성되고\n중간중간 POOL이 구성되어 있으며 마지막에는 FC로 구성되어 있다. Image Input \n위 그림의 크기가 이고 색상을 갖고 있기 때문에\n3(Red, Green, Blue…","html":"<p>해당 게시물은 <a href=\"https://www.edwith.org\">Edwith</a>에서 제공하는<br/>\n<a href=\"https://www.edwith.org/others26/joinLectures/9829\">머신러닝과 딥러닝 BASIC</a>을 듣고 요약 정리한 글입니다.</p>\n<h2 id=\"convolutional-neural-network\" style=\"position:relative;\"><a href=\"#convolutional-neural-network\" aria-label=\"convolutional neural network permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Convolutional Neural Network</h2>\n<p>고양이가 어떠한 사물을 볼때 뇌 전체가 아닌<br/>\n<strong>일부</strong>만 <strong>활성화</strong> 된다는 사실을 발견함에서 시작<br/></p>\n<p>기본적인 <strong>CNN</strong>의 구성으로 <strong>CONV</strong>와 <strong>RELU</strong>가 한 쌍으로 구성되고<br/>\n중간중간 <strong>POOL</strong>이 구성되어 있으며 마지막에는 <strong>FC</strong>로 구성되어 있다.<br/></p>\n<h2 id=\"image-input\" style=\"position:relative;\"><a href=\"#image-input\" aria-label=\"image input permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Image Input</h2>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 288px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 116.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAYAAAALHW+jAAAACXBIWXMAAAsTAAALEwEAmpwYAAABmUlEQVQ4y8WVSYsCMRCF+///Fq/eRPDiWUVFBHdx3/f9zXyBamI7M+2gwwSKdCeVl1cvlUqgz3a73eh0vV612Wx0uVzc/2630+FwcN/H41Hn81nRZmutBf4gi1OplEqlkqrVqrLZrHK5nCqViorFovL5vJLJpNLptBKJhIbDYQhqGEGU4WQy0Xq91na71WKx0HK5dEwZg/1gMFCz2VS5XHb+UZaBTz1KP67t93u3oQ8a/BbEb8hSq9XC6O5CtpCeMeTAv9vtOln8CEOGiM+OOLXb7VjrdDpOy3q9rtlsFmZGCFgoFJwjO06nU+cUZ+Px2B0YOlp63QG2Wi3N53N30nHGpqPRyEkAIHn6IyALvrM/B0Sm2JCfBeTE0fF0Or0OaHqSi5bgLwFi/X5fmUxGvV7vfRquVqv3HQoa/k/avJzY3OXvGPogvgFICUPDhzykKHDZ7Y4CYD0MALB/Myo2oMw95CEDTFI1oI8xRtI2Gg3HgjclOkfVMbC78oUzDKySsCvhM8Y7wkJA/UrEt4X65ZvyVbPCGedj/Qea291Qjh145QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"아직 안만듬\" title=\"아직 안만듬\" src=\"/static/416820e162a2b81206c8b2621c0e3386/477c9/1.png\" srcset=\"/static/416820e162a2b81206c8b2621c0e3386/8a4e8/1.png 150w,\n/static/416820e162a2b81206c8b2621c0e3386/477c9/1.png 288w\" sizes=\"(max-width: 288px) 100vw, 288px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span><br/>\n위 그림의 크기가 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>32</mn><mo>×</mo><mn>32</mn></mrow><annotation encoding=\"application/x-tex\">32 \\times 32</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">32</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">32</span></span></span></span>이고 색상을 갖고 있기 때문에<br/>\n3(Red, Green, Blue)을 곱해 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>32</mn><mo>×</mo><mn>32</mn><mo>×</mo><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">32 \\times 32 \\times 3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">32</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">32</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">3</span></span></span></span>크기다.<br/>\n픽셀 1개는 흑백의 경우 1Byte를 사용하기 때문에<br/>\n256단계의 Grey Scale을 표현할 수 있고<br/>\n컬러의 경우 RGB에 1Byte씩 할당하기 때문에<br/>\n<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>256</mn><mo>×</mo><mn>256</mn><mo>×</mo><mn>256</mn></mrow><annotation encoding=\"application/x-tex\">256 \\times 256 \\times 256</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">256</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">256</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">256</span></span></span></span>만큼의 색상을 표현할 수 있다.<br/></p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 408px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 67.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABeklEQVQ4y6WTzVLCMBSF+1S+gmsfx40+gONLuNWNe7duZBhhQO1QKKVKaZs2JQEKBdrjTX/kZ0CH8c6cJjdNvp6bpFq324WS67pwHGej4RccP8Tw7QXO7QVE8wkqsjTFb6H1ej3Yto3xeIwwDDcKAvBJjECvgV2fQdYeS+D6b+BgMEAURQgIsqsCzLwRBH0wB2bZacBtl1XOCCyE/B9wu88YI6D4v8NjwEqH8p9DOQVYxb5blR8H7pV/1OF6hWyVbBwahgHLssA5z50oKQBTKvPDJadQiPHDFaKbc6RxcWhaUC6UUuZ3sWpF2Z9Op7n7iZQ7QLqQeb54vsP8/hJYJwVQPfr9PkzTxIj+kA9dh0eHZNbr0DsdvDYacD2vgJVSkRLUonlDP8CQcVitNma+XwBVucqppLJcGpTkmHcNOJ823ptNCHoHtVcJ7dWSnJCyZIHI9yCYD8FD8HYLS5qnHb1Xq2UhVRotzuIpEM9yZWWrxpHMi3YxV/uBb26k4NLHA+bPAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"아직 안만듬\" title=\"아직 안만듬\" src=\"/static/3c8db9053f1c05748e7377eb61435799/e7c18/2.png\" srcset=\"/static/3c8db9053f1c05748e7377eb61435799/8a4e8/2.png 150w,\n/static/3c8db9053f1c05748e7377eb61435799/5a46d/2.png 300w,\n/static/3c8db9053f1c05748e7377eb61435799/e7c18/2.png 408w\" sizes=\"(max-width: 408px) 100vw, 408px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span><br/>\n위의 이미지 처럼 전체의 이미지를 한번에 처리하지않고<br/>\n<strong>일부분</strong>만 처리(<strong>Filter</strong>)하며 필터의 Size는<br/>\n임의로 정의할 수 있으나 색상은 항상 같은 값이다.<br/></p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 376px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 72%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAABLklEQVQ4y81TS2qEQBScM2aXTQ6QywRmn8MIuhVUEAQhYDKjtv+/glrp14OgRqNklYbyPbvpooqud+n7HlEUIU3TbSTJo+YFqqbF0bo0TQNN0+D7/k94HnzG4N2/4F2f4b2/om47ZFmGrusE6H5RFGjbFuM4PggNw0Acx0LpGnGcIGI+2NsTPq4v+LzdoSgKdF0XQmRZhiRJME1zSUiXwzDch++CubdzlteEc4Vij3rugAUBhmEQSvbwK+HUi8rBuHUipLVFdkrhnJjxB5oT/sny/yI8wilCCiRlah2TgL/oVCdQ2A8J6SDh40XI81xMAY0apZ9qWZZiGqqqEmcT0S7h1FDqbdsWIMWO48CyLLFPk6Cq6iIuu8GmD9kgRXVdL2aT/ql3XVc4WOdva30DBDMtJjSXmNUAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"아직 안만듬\" title=\"아직 안만듬\" src=\"/static/d08e2a65575e8aff2828505293626eb6/d38a6/3.png\" srcset=\"/static/d08e2a65575e8aff2828505293626eb6/8a4e8/3.png 150w,\n/static/d08e2a65575e8aff2828505293626eb6/5a46d/3.png 300w,\n/static/d08e2a65575e8aff2828505293626eb6/d38a6/3.png 376w\" sizes=\"(max-width: 376px) 100vw, 376px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span><br/>\n하나의 필터가 하는 일은 궁극적으로 <strong>하나의 값을 생성</strong>한다.<br/></p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 41.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABE0lEQVQoz51Ru26EMBDk//8hf5EiRdpUuZYiFEi8wWdj3hxwMGE2AekipUhWGi3srscza0cpBaIsSxitYeoW2n2DfX9GN064jSP6vse4599i27bz2wmCAFmWwRgDfVXQdQd1eYF6fUKqDKIohOd50ufBOAzx4bpSy/Mc1toHUieKImmIwv0QVWpbo+pvMrCuq+BUc79jGYazviyLkB14INS0LEqvqGwpBEmSiApaZq6qCnZHHMeyip9xEgoR1X2D/6xzv+Fuk5nkvu/L5bR8iOBFTdNgnuevHRZFIUWSHNaZWZumSYbbtkXXdWetrmsMu3UqZp892nfYSNNU1JCYD0Rw4D/hcJGHXaoiMW3xtuP1/oJPznVlJ9RT5LMAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"아직 안만듬\" title=\"아직 안만듬\" src=\"/static/5d08ad33c91bca9c371f1581f4f715f0/0a47e/4.png\" srcset=\"/static/5d08ad33c91bca9c371f1581f4f715f0/8a4e8/4.png 150w,\n/static/5d08ad33c91bca9c371f1581f4f715f0/5a46d/4.png 300w,\n/static/5d08ad33c91bca9c371f1581f4f715f0/0a47e/4.png 600w,\n/static/5d08ad33c91bca9c371f1581f4f715f0/dba9a/4.png 652w\" sizes=\"(max-width: 600px) 100vw, 600px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span><br/>\n지금까지 많이 사용한 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>W</mi><mi>x</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">Wx + b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>의 식을 사용해 하나의 값을 생성한다.<br/>\n<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>5</mn><mo>×</mo><mn>5</mn><mo>×</mo><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">5 \\times 5 \\times 3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">5</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">5</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">3</span></span></span></span>의 필터에서는 아래와 같은 식으로 값이 생성된다.<br/>\n<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>W</mi><mn>1</mn></msub><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>W</mi><mn>2</mn></msub><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><msub><mi>W</mi><mn>3</mn></msub><msub><mi>x</mi><mn>3</mn></msub><mo>+</mo><msub><mi>W</mi><mn>4</mn></msub><msub><mi>x</mi><mn>4</mn></msub><mo>+</mo><msub><mi>W</mi><mn>5</mn></msub><msub><mi>x</mi><mn>5</mn></msub><mo>+</mo><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">W_{1}x_{1} + W_{2}x_{2} + W_{3}x_{3} + W_{4}x_{4} + W_{5}x_{5} + b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">4</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">4</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">5</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">5</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span><br/>\n이 식에서 변하지 않는 <strong>Weight</strong>이 어떤 값을 만들지 결정한다.<br/>\n<strong>ReLU</strong>라는 함수를 붙이기만 하면 <strong>ReLU Layer</strong>가 생성이 된다.<br/></p>\n<p>하나의 filter로 값을 생성할 때 옆으로 움직이는 칸의 단위를 <strong>Stride</strong>라고 한다.<br/>\n출력값의 크기는 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>N</mi><mo>−</mo><mi>F</mi><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">/</mi><mi>S</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>d</mi><mi>e</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">(N - F) / Stride + 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mclose\">)</span><span class=\"mord\">/</span><span class=\"mord mathnormal\">St</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">e</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>의 크기를 갖는다.<br/></p>\n<p>Stride가 클수록 출력값의 크기가 작아져 정보를 잃어버리게 되어<br/>\n<strong>CNN</strong>을 구성할 때 <strong>Pad</strong>라는 개념을 사용한다.<br/></p>\n<h3 id=\"pad를-사용하는-이유\" style=\"position:relative;\"><a href=\"#pad%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EB%8A%94-%EC%9D%B4%EC%9C%A0\" aria-label=\"pad를 사용하는 이유 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Pad를 사용하는 이유</h3>\n<ol>\n<li>그림이 작아지는 것을 방지</li>\n<li>그림의 모서리임을 알려주기 위해서</li>\n</ol>\n<h2 id=\"pad-사용-예시\" style=\"position:relative;\"><a href=\"#pad-%EC%82%AC%EC%9A%A9-%EC%98%88%EC%8B%9C\" aria-label=\"pad 사용 예시 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Pad 사용 예시</h2>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 58.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAACD0lEQVQoz32Ta4+aUBCG/f8f+gN2k02T9kvb6MbQVdnUiK6IknpJmrpBrYKCKDfFO97eZY5LZTdNJ5mQcIbnvPPOkMBrnM9n9lwsFvA8D8PhELquY7lcwnEcdDoduK6D3W4L3dAxHo+jT3E6nVgSI/EeGAQBttstZrMZLMsKATtsNhvYto1gt2c1juVgMBiEF7isLh6JCHY6n1j+L6y5if5YgaL9RlWWIJZFiKIIRVFYR6QyESn7V9BZdBlFvsHhLvsBX4o3+CHwKAollEolZDIZJJNJ1h1TGOx30G0VY1eD69thi1vm3eFwuHj0Cnz6xeNr+Qbf658xmmiYz3zM53OMRiM8ZB6uQHdh4Vv5FvfyHeTnYuiRC1VTsV6v3/griHlIjSeoZhcTywx9ddgAVVVFNpu9Ar2FjXvpI7j6J9Q7IlznMuUIuN9fhvHIP6L+swHX9tiUDcPAdDpFt9sFx3FX4GazhvLnGarex8gYsiIC+r7Pptvv97FarSAIApqtJlNFG0BJkyaF5ONfIK2GoRtwbBfW9FJIvrxXWCgU0G632RrRZZRUQ2pzudwVSHunDTWmhtTRIsdbjjzkeR7pdBqSJKEsllGpVFCtVpHP55FKpa7A4/HIpkUggk4mE9YWvY8D6ZJmswlZllGr1RiQstVqodfrsfpE/A8hEMmnRSXP4rD4vpJyOqda0zTf7O4Ll8J+jG5QP/4AAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"아직 안만듬\" title=\"아직 안만듬\" src=\"/static/a9cb3bc82c074a6044594d8638a02d90/0a47e/5.png\" srcset=\"/static/a9cb3bc82c074a6044594d8638a02d90/8a4e8/5.png 150w,\n/static/a9cb3bc82c074a6044594d8638a02d90/5a46d/5.png 300w,\n/static/a9cb3bc82c074a6044594d8638a02d90/0a47e/5.png 600w,\n/static/a9cb3bc82c074a6044594d8638a02d90/1cfc2/5.png 900w,\n/static/a9cb3bc82c074a6044594d8638a02d90/c1b63/5.png 1200w,\n/static/a9cb3bc82c074a6044594d8638a02d90/78363/5.png 1522w\" sizes=\"(max-width: 600px) 100vw, 600px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span><br/>\n원본 이미지의 크기가 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>7</mn><mo>×</mo><mn>7</mn></mrow><annotation encoding=\"application/x-tex\">7 \\times 7</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">7</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">7</span></span></span></span>의 크기고 <strong>1 Stride</strong>로<br/>\n<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>3</mn><mo>×</mo><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">3 \\times 3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">3</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">3</span></span></span></span>크기의 필터를 사용한다고 가정했을때<br/>\n<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>5</mn><mo>×</mo><mn>5</mn></mrow><annotation encoding=\"application/x-tex\">5 \\times 5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">5</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">5</span></span></span></span>의 출력값을 얻을 수 있었지만<br/>\n1개의 <strong>Pad</strong>를 추가한 결과 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>7</mn><mo>×</mo><mn>7</mn></mrow><annotation encoding=\"application/x-tex\">7 \\times 7</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">7</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">7</span></span></span></span>의 출력값을 얻을 수 있다.<br/></p>\n<p>보통 Pad를 추가하였을때 입력값의 크기와 출력값의 크기가 같도록 설정한다.<br/></p>\n<h2 id=\"convolution-layer\" style=\"position:relative;\"><a href=\"#convolution-layer\" aria-label=\"convolution layer permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Convolution Layer</h2>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 39.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB1UlEQVQoz1WSy4vTUBTG8x+6ceHKWTkuBhduRHAxzCiIIAji0p0woHRaoYgwC0VRfIyD4nQeTF+ZJm3TtE3zaJImuTc/7w1W8MJHbs7hfPc75ztGEARoRFFEGIYV4jhGn7IsEXlGka3+QUr5NyeRQv0XKUJBiqyKG4PBAMdxmE6nuK7LZDJhPp9XyVyRDQ+eE759QnjwjODNY5Yn76tcloaMju5TdHcUHpB3dsmDYwzbtisyTaIxm83wPI+8KCrVg4Yiqd1j+XqX6NVdlt9q5CX43oT2u5uIkw3K801k6xrFaO9/Qk22xnjscGma2M2nLBs7RM2HRPVtwu91BiMXy2zT+3gLeXaD8mKL8mwD4dQwLMuqWl0T6XuoZqrHoO9W/ZFSdkeRbhPs3Sb5sY/jBXhzl96HLeTxVTi/Tvn7CsXwBYYu1OoWiwUL1ar++gpSCGVASdT7Sfyphv+5weqwSXZxhIwTUN6k3imp9ZLE3ke6dUTYwkjTFHs4ZKrMcNsXdLtdktWK9VmpQrPT5/TrIf2OidBBvQV5TqyG2b50aX35hdmf6Dcw9BpkikCbkKsWE6VY+D7KEdQOIRYeha8UO2NWSVwVoUQo56q48GbIsa04Ykop+APkLElQF6HeSQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"아직 안만듬\" title=\"아직 안만듬\" src=\"/static/d656a49385e834927ec583dda0887c16/0a47e/6.png\" srcset=\"/static/d656a49385e834927ec583dda0887c16/8a4e8/6.png 150w,\n/static/d656a49385e834927ec583dda0887c16/5a46d/6.png 300w,\n/static/d656a49385e834927ec583dda0887c16/0a47e/6.png 600w,\n/static/d656a49385e834927ec583dda0887c16/1cfc2/6.png 900w,\n/static/d656a49385e834927ec583dda0887c16/c1b63/6.png 1200w,\n/static/d656a49385e834927ec583dda0887c16/2093e/6.png 1858w\" sizes=\"(max-width: 600px) 100vw, 600px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span><br/>\nfilter를 적용해 만들어진 출력 결과를 <strong>Activation Map</strong>이라고 한다.<br/>\n여러개의 <strong>Convolution Layer</strong>를 겹쳐 사용할 수 있다.<br/></p>\n<p><strong>filter의 깊이는 이미지의 깊이와 동일해야 한다.</strong><br/></p>\n<p>Layer를 구성할 때 많은 <strong>Weight</strong>값이 존재하는 데 이 값들은<br/>\nNeural Network과 동일하게 초기화 후 학습을 진행한다.</p>","frontmatter":{"title":"ConvNet의 Conv 레이어 만들기","date":"June 06, 2019","thumbnail":null}}},"pageContext":{"slug":"/MachineLearning/2019-06-06-BasicChapter12-1/","previous":{"fields":{"slug":"/MachineLearning/2019-06-03-BasicChapter11-5-NN-Dropout/"},"frontmatter":{"title":"Drop Out을 사용해 MNIST 정확도 높이기","category":"Machine Learning","draft":false}},"next":{"fields":{"slug":"/MachineLearning/2019-06-06-BasicChapter12-2/"},"frontmatter":{"title":"ConvNet Max pooling 과 Full Network","category":"Machine Learning","draft":false}}}},"staticQueryHashes":["3001444076","3128451518"]}